import{_ as s,o as a,c as n,Q as p}from"./chunks/framework.933211d3.js";const l="/wpmjs/build/assets/17000385880541.0d192f07.jpg",m=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"api/wpmjs.md","filePath":"api/wpmjs.md","lastUpdated":1705906671000}'),o={name:"api/wpmjs.md"},e=p(`<h2 id="wpmjs-web-package-manager" tabindex="-1">wpmjs（web package manager） <a class="header-anchor" href="#wpmjs-web-package-manager" aria-label="Permalink to &quot;wpmjs（web package manager）&quot;">​</a></h2><p>wpmjs是一个能够加载umd、system、module-federation并共享依赖的加载器, 支持自定义或扩展模块加载器、支持多版本共存, 还配套了调试插件和打包工具插件</p><blockquote><p>默认使用<a href="https://npmjs.com/package/systemjs" target="_blank" rel="noreferrer">systemjs</a>和<a href="https://npmjs.com/package/module-federation-runtime" target="_blank" rel="noreferrer">module-federation-runtime</a>来加载各种模块, 也可以重新自行实现默认行为</p></blockquote><h2 id="在线示例" tabindex="-1">在线示例 <a class="header-anchor" href="#在线示例" aria-label="Permalink to &quot;在线示例&quot;">​</a></h2><p><a href="https://zhanghongen.github.io/universal-module-federation-plugin/" target="_blank" rel="noreferrer">去体验</a>, 下面的demo演示了使用 远程mf模块 + 远程umd模块 + 本地react模块</p><blockquote><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> wpmjs </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;wpmjs&quot;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> React </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;react&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">setConfig</span><span style="color:#E1E4E8;">({ baseUrl: </span><span style="color:#9ECBFF;">&quot;https://cdn.jsdelivr.net/npm&quot;</span><span style="color:#E1E4E8;"> })</span></span>
<span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">addImportMap</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 统一域名</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;antd&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;antd@5.9.0/dist/antd.min.js&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;dayjs&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;dayjs@1.11.1&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 自定义url</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;mf-app-01&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;mfapp01@https://cdn.jsdelivr.net/npm/mf-app-01@1.0.5/dist/remoteEntry.js&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;react-dom&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.development.js&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span>
<span class="line"><span style="color:#6A737D;">// umd、system、mf都会优先寻找此处写入的依赖</span></span>
<span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">setShared</span><span style="color:#E1E4E8;">({ name: </span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;">, version: </span><span style="color:#9ECBFF;">&quot;18.2.0&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">: () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> React })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> wpmjs.</span><span style="color:#B392F0;">import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;mf-app-01&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> wpmjs.</span><span style="color:#B392F0;">import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;antd&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> wpmjs </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;wpmjs&quot;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> React </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;react&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">setConfig</span><span style="color:#24292E;">({ baseUrl: </span><span style="color:#032F62;">&quot;https://cdn.jsdelivr.net/npm&quot;</span><span style="color:#24292E;"> })</span></span>
<span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">addImportMap</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 统一域名</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;antd&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;antd@5.9.0/dist/antd.min.js&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;dayjs&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;dayjs@1.11.1&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 自定义url</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;mf-app-01&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;mfapp01@https://cdn.jsdelivr.net/npm/mf-app-01@1.0.5/dist/remoteEntry.js&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;react-dom&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.development.js&quot;</span></span>
<span class="line"><span style="color:#24292E;">})</span></span>
<span class="line"><span style="color:#6A737D;">// umd、system、mf都会优先寻找此处写入的依赖</span></span>
<span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">setShared</span><span style="color:#24292E;">({ name: </span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">, version: </span><span style="color:#032F62;">&quot;18.2.0&quot;</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">: () </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> React })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> wpmjs.</span><span style="color:#6F42C1;">import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;mf-app-01&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> wpmjs.</span><span style="color:#6F42C1;">import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;antd&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">)</span></span></code></pre></div></blockquote><h3 id="develop-plugins-调试插件" tabindex="-1">develop-plugins（调试插件） <a class="header-anchor" href="#develop-plugins-调试插件" aria-label="Permalink to &quot;develop-plugins（调试插件）&quot;">​</a></h3><p>develop-plugins是一个可扩展的调试面板（<a href="./../contribute/develop-plugins.html">开发调试插件</a>）, 系统插件connect和alias可以提供一键切换本地dev-server和调试指定版本的能力。 <img src="`+l+`" alt=""></p><h3 id="构建工具" tabindex="-1">构建工具 <a class="header-anchor" href="#构建工具" aria-label="Permalink to &quot;构建工具&quot;">​</a></h3><p>使用同步语法加载远程模块</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// bootstrap.js</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> React </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// react is remote module</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// bootstrap.js</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> React </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// react is remote module</span></span></code></pre></div><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NpmFederation</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">  remotes: {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;react-dom&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.development.js&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">  },</span></span>
<span class="line"><span style="color:#E1E4E8;">  shared: {react: {}}</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NpmFederation</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">  remotes: {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;react-dom&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.development.js&quot;</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">  shared: {react: {}}</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre></div><ol><li><a href="https://github.com/zhangHongEn/universal-module-federation-plugin/tree/main/packages/npm-federation-webpack" target="_blank" rel="noreferrer">npm-federation</a></li></ol><h3 id="加载器" tabindex="-1">加载器 <a class="header-anchor" href="#加载器" aria-label="Permalink to &quot;加载器&quot;">​</a></h3><p>修改默认加载器或开发新加载器请看API: registerLoader() 部分</p><h2 id="api" tabindex="-1">API <a class="header-anchor" href="#api" aria-label="Permalink to &quot;API&quot;">​</a></h2><h2 id="setconfig" tabindex="-1">setConfig() <a class="header-anchor" href="#setconfig" aria-label="Permalink to &quot;setConfig()&quot;">​</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">setConfig</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">  baseUrl: string; </span><span style="color:#6A737D;">// 统一url</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">defaultModuleType</span><span style="color:#E1E4E8;">(name): string; </span><span style="color:#6A737D;">// 加载未设置moduleType的模块时使用的模块类型</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">defaultVersion</span><span style="color:#E1E4E8;">(name: string): string; </span><span style="color:#6A737D;">// 加载未设置packageVersion的模块时使用的版本</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">defaultImportMap</span><span style="color:#E1E4E8;">(name: string): Map; </span><span style="color:#6A737D;">// 详看addImportMap</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">defaultGlobal</span><span style="color:#E1E4E8;">({name, version}): string; </span><span style="color:#6A737D;">// 加载未设置global的模块时使用的key</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">setConfig</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">  baseUrl: string; </span><span style="color:#6A737D;">// 统一url</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">defaultModuleType</span><span style="color:#24292E;">(name): string; </span><span style="color:#6A737D;">// 加载未设置moduleType的模块时使用的模块类型</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">defaultVersion</span><span style="color:#24292E;">(name: string): string; </span><span style="color:#6A737D;">// 加载未设置packageVersion的模块时使用的版本</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">defaultImportMap</span><span style="color:#24292E;">(name: string): Map; </span><span style="color:#6A737D;">// 详看addImportMap</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">defaultGlobal</span><span style="color:#24292E;">({name, version}): string; </span><span style="color:#6A737D;">// 加载未设置global的模块时使用的key</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre></div><p>全局配置</p><ol><li>注意, 这个demo并不是wpmjs的默认值<div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">setConfig</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">  baseUrl: </span><span style="color:#9ECBFF;">&quot;https://cdn.jsdelivr.net/npm/&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">defaultModuleType</span><span style="color:#E1E4E8;">() { </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;system&quot;</span><span style="color:#E1E4E8;"> },</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">defaultVersion</span><span style="color:#E1E4E8;">() { </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;latest&quot;</span><span style="color:#E1E4E8;"> },</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">defaultImportMap</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">name</span><span style="color:#E1E4E8;">) { </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> {packageName: name, packageQuery: </span><span style="color:#9ECBFF;">&quot;v=&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+new</span><span style="color:#E1E4E8;"> Date} },</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">defaultGlobal</span><span style="color:#E1E4E8;">({</span><span style="color:#FFAB70;">name</span><span style="color:#E1E4E8;">}) {</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> name}</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">setConfig</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">  baseUrl: </span><span style="color:#032F62;">&quot;https://cdn.jsdelivr.net/npm/&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">defaultModuleType</span><span style="color:#24292E;">() { </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;system&quot;</span><span style="color:#24292E;"> },</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">defaultVersion</span><span style="color:#24292E;">() { </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;latest&quot;</span><span style="color:#24292E;"> },</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">defaultImportMap</span><span style="color:#24292E;">(</span><span style="color:#E36209;">name</span><span style="color:#24292E;">) { </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> {packageName: name, packageQuery: </span><span style="color:#032F62;">&quot;v=&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+new</span><span style="color:#24292E;"> Date} },</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">defaultGlobal</span><span style="color:#24292E;">({</span><span style="color:#E36209;">name</span><span style="color:#24292E;">}) {</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> name}</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre></div></li></ol><h2 id="addimportmap" tabindex="-1">addImportMap() <a class="header-anchor" href="#addimportmap" aria-label="Permalink to &quot;addImportMap()&quot;">​</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">addImportMap</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">  [key: string]: string </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    url?: string; </span><span style="color:#6A737D;">// 自定义url</span></span>
<span class="line"><span style="color:#E1E4E8;">    global</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> string; </span><span style="color:#6A737D;">// global的变量名</span></span>
<span class="line"><span style="color:#E1E4E8;">    moduleType</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> string; </span><span style="color:#6A737D;">// 模块类型</span></span>
<span class="line"><span style="color:#E1E4E8;">    packageName</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> string; </span><span style="color:#6A737D;">// 包名, 会用作统一url规则的拼接</span></span>
<span class="line"><span style="color:#E1E4E8;">    packageQuery</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> string; </span><span style="color:#6A737D;">// 查询参数, 会用作统一url规则的拼接 </span></span>
<span class="line"><span style="color:#E1E4E8;">    packageVersion</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> string; </span><span style="color:#6A737D;">// 包版本, 会用作统一url规则的拼接</span></span>
<span class="line"><span style="color:#E1E4E8;">    packageFilename</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> string; </span><span style="color:#6A737D;">// 包入口文件, 会用作同意url规则的拼接</span></span>
<span class="line"><span style="color:#E1E4E8;">    strictVersion</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> boolean; </span><span style="color:#6A737D;">// 获取到的共享模块与指定版本不符则会发起请求加载指定版本</span></span>
<span class="line"><span style="color:#E1E4E8;">    shareScope</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> string; </span><span style="color:#6A737D;">// 寻找依赖的空间</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">addImportMap</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">  [key: string]: string </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    url?: string; </span><span style="color:#6A737D;">// 自定义url</span></span>
<span class="line"><span style="color:#24292E;">    global</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> string; </span><span style="color:#6A737D;">// global的变量名</span></span>
<span class="line"><span style="color:#24292E;">    moduleType</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> string; </span><span style="color:#6A737D;">// 模块类型</span></span>
<span class="line"><span style="color:#24292E;">    packageName</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> string; </span><span style="color:#6A737D;">// 包名, 会用作统一url规则的拼接</span></span>
<span class="line"><span style="color:#24292E;">    packageQuery</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> string; </span><span style="color:#6A737D;">// 查询参数, 会用作统一url规则的拼接 </span></span>
<span class="line"><span style="color:#24292E;">    packageVersion</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> string; </span><span style="color:#6A737D;">// 包版本, 会用作统一url规则的拼接</span></span>
<span class="line"><span style="color:#24292E;">    packageFilename</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> string; </span><span style="color:#6A737D;">// 包入口文件, 会用作同意url规则的拼接</span></span>
<span class="line"><span style="color:#24292E;">    strictVersion</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> boolean; </span><span style="color:#6A737D;">// 获取到的共享模块与指定版本不符则会发起请求加载指定版本</span></span>
<span class="line"><span style="color:#24292E;">    shareScope</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> string; </span><span style="color:#6A737D;">// 寻找依赖的空间</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre></div><p>配置模块映射, 多个属性可分多次配置, 每个属性以第一次注册为准, 多次注册不会产生覆盖。其中如果有不规则的远程模块链接可以设置url属性, 否则推荐通过packageName、packageVersion等属性统一管理远程模块的链接。</p><ol><li>字符串简写语法: 通过url映射umd和mf模块 <ol><li>global@https?😕/开头的设置为mf<div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">addImportMap</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 等同于配置: {moduleType: &quot;mf&quot;, global, url}</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;mf-app-01&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;mfapp01@https://cdn.jsdelivr.net/npm/mf-app-01@1.0.5/dist/remoteEntry.js&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">addImportMap</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 等同于配置: {moduleType: &quot;mf&quot;, global, url}</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;mf-app-01&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;mfapp01@https://cdn.jsdelivr.net/npm/mf-app-01@1.0.5/dist/remoteEntry.js&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre></div></li><li>https?😕/开头的设置为system<div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">addImportMap</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 等同于配置: {moduleType: &quot;system&quot;, url}</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;react-dom&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.development.js&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">addImportMap</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 等同于配置: {moduleType: &quot;system&quot;, url}</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;react-dom&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.development.js&quot;</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre></div></li></ol></li><li>简写语法: 通过npm包名语法映射配置 <ol><li>含有remoteEntry.js设置为mf<div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">addImportMap</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 等同于配置: {moduleType: &quot;mf&quot;, packageName: &quot;mf-app-01&quot;, packageVersion: &quot;1.0.5&quot;, packageFilename: &quot;dist/remoteEntry.js&quot;}</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;mf-app-01&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;mf-app-01@1.0.5/dist/remoteEntry.js&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">addImportMap</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 等同于配置: {moduleType: &quot;mf&quot;, packageName: &quot;mf-app-01&quot;, packageVersion: &quot;1.0.5&quot;, packageFilename: &quot;dist/remoteEntry.js&quot;}</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;mf-app-01&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;mf-app-01@1.0.5/dist/remoteEntry.js&quot;</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre></div></li><li>无remoteEntry.js设置为system<div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">addImportMap</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 等同于配置: {moduleType: &quot;system&quot;, packageName: &quot;react-dom&quot;, packageFilename: &quot;dist/umd/react-dom.development.js&quot;}</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;react-dom&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;react-dom/umd/react-dom.development.js&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">addImportMap</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 等同于配置: {moduleType: &quot;system&quot;, packageName: &quot;react-dom&quot;, packageFilename: &quot;dist/umd/react-dom.development.js&quot;}</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;react-dom&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;react-dom/umd/react-dom.development.js&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre></div></li><li>无filename不设置moduleType<div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">addImportMap</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">     </span><span style="color:#6A737D;">// 等同于配置: {packageName: &quot;react&quot;, packageVersion: &quot;18.2.0&quot;}</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;react@18.2.0&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">addImportMap</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">     </span><span style="color:#6A737D;">// 等同于配置: {packageName: &quot;react&quot;, packageVersion: &quot;18.2.0&quot;}</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;react@18.2.0&quot;</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre></div></li></ol></li><li>对象语法: 可以分多次分别设置{moduleType, global, packageName, packageQuery, packageVersion, packageFilename, strictVersion, shareScope } 。 <ol><li>单独设置包版本<div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">addImportMap</span><span style="color:#E1E4E8;">({ </span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;">: {packageVersion: </span><span style="color:#9ECBFF;">&quot;18.2.0&quot;</span><span style="color:#E1E4E8;">, moduleType: </span><span style="color:#9ECBFF;">&quot;system&quot;</span><span style="color:#E1E4E8;">}, </span><span style="color:#9ECBFF;">&quot;react-dom&quot;</span><span style="color:#E1E4E8;">: { packageVersion: </span><span style="color:#9ECBFF;">&quot;18.2.0&quot;</span><span style="color:#E1E4E8;"> } })</span></span>
<span class="line"><span style="color:#6A737D;">// react-dom会使用18.2.0版本而不是17.0.2</span></span>
<span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">addImportMap</span><span style="color:#E1E4E8;">({ </span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;react-dom&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;react-dom@17.0.2/umd/react-dom.development.js&quot;</span><span style="color:#E1E4E8;"> })</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">addImportMap</span><span style="color:#24292E;">({ </span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">: {packageVersion: </span><span style="color:#032F62;">&quot;18.2.0&quot;</span><span style="color:#24292E;">, moduleType: </span><span style="color:#032F62;">&quot;system&quot;</span><span style="color:#24292E;">}, </span><span style="color:#032F62;">&quot;react-dom&quot;</span><span style="color:#24292E;">: { packageVersion: </span><span style="color:#032F62;">&quot;18.2.0&quot;</span><span style="color:#24292E;"> } })</span></span>
<span class="line"><span style="color:#6A737D;">// react-dom会使用18.2.0版本而不是17.0.2</span></span>
<span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">addImportMap</span><span style="color:#24292E;">({ </span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;react-dom&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;react-dom@17.0.2/umd/react-dom.development.js&quot;</span><span style="color:#24292E;"> })</span></span></code></pre></div></li></ol></li></ol><h2 id="import" tabindex="-1">import() <a class="header-anchor" href="#import" aria-label="Permalink to &quot;import()&quot;">​</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">import</span><span style="color:#E1E4E8;">(request: string): </span><span style="color:#79B8FF;">Promise</span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">Module </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> any</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">import</span><span style="color:#24292E;">(request: string): </span><span style="color:#005CC5;">Promise</span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">Module </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> any</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><p>加载并获取远程模块, 会自动缓存不进行多次请求, request可以是一个模块名, 也可以是一个模块+入口路径名</p><ol><li>直接加载某个入口, 结果等同于2</li></ol><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">entry</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> wpmjs.</span><span style="color:#B392F0;">import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;mf-app-01/App&quot;</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">entry</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> wpmjs.</span><span style="color:#6F42C1;">import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;mf-app-01/App&quot;</span><span style="color:#24292E;">)</span></span></code></pre></div><ol start="2"><li>只加载某个模块, 不加载具体的入口</li></ol><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">module</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> wpmjs.</span><span style="color:#B392F0;">import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;mf-app-01&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#6A737D;">// 需要的时候再加载入口./App</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">entry</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> container.</span><span style="color:#B392F0;">$getEntry</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;./App&quot;</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">module</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> wpmjs.</span><span style="color:#6F42C1;">import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;mf-app-01&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#6A737D;">// 需要的时候再加载入口./App</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">entry</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> container.</span><span style="color:#6F42C1;">$getEntry</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;./App&quot;</span><span style="color:#24292E;">)</span></span></code></pre></div><blockquote><p>对应写法2, 入参是一个模块名不包含入口路径的时候, 会为返回值挂载$getEntry来抹平各种类型的模块获取入口的方式。wpmjs为每种模块提供了默认的入口解析行为, 但你也可以进行自定义。</p><ul><li>umd或system模块: <a href="./src/extras/umdAndSystem.js">wpmjs/src/extras/umdAndSystem.js</a> resolveEntry()</li></ul><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">umdModule.</span><span style="color:#B392F0;">$getEntry</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;App&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">====</span><span style="color:#E1E4E8;">内部逻辑等于</span><span style="color:#F97583;">====</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> umdModule[</span><span style="color:#9ECBFF;">&quot;App&quot;</span><span style="color:#E1E4E8;">]()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">umdModule.</span><span style="color:#6F42C1;">$getEntry</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;App&quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">====</span><span style="color:#24292E;">内部逻辑等于</span><span style="color:#D73A49;">====</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> umdModule[</span><span style="color:#032F62;">&quot;App&quot;</span><span style="color:#24292E;">]()</span></span></code></pre></div><ul><li>module-federation模块: <a href="./src/extras/mf.js">wpmjs/src/extras/mf.js</a> resolveEntry()</li></ul><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">mfModule.</span><span style="color:#B392F0;">$getEntry</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;App&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">====</span><span style="color:#E1E4E8;">内部逻辑等于</span><span style="color:#F97583;">====</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> mfModule.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;App&quot;</span><span style="color:#E1E4E8;">))()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">mfModule.</span><span style="color:#6F42C1;">$getEntry</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;App&quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">====</span><span style="color:#24292E;">内部逻辑等于</span><span style="color:#D73A49;">====</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> mfModule.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;App&quot;</span><span style="color:#24292E;">))()</span></span></code></pre></div><ul><li>json模块: <a href="./src/extras/json.js">wpmjs/src/extras/json.js</a> resolveEntry()</li></ul><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">jsonModule.</span><span style="color:#B392F0;">$getEntry</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;App&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">====</span><span style="color:#E1E4E8;">内部逻辑等于</span><span style="color:#F97583;">====</span><span style="color:#E1E4E8;"> jsonModule[</span><span style="color:#9ECBFF;">&quot;App&quot;</span><span style="color:#E1E4E8;">]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">jsonModule.</span><span style="color:#6F42C1;">$getEntry</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;App&quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">====</span><span style="color:#24292E;">内部逻辑等于</span><span style="color:#D73A49;">====</span><span style="color:#24292E;"> jsonModule[</span><span style="color:#032F62;">&quot;App&quot;</span><span style="color:#24292E;">]</span></span></code></pre></div></blockquote><h2 id="get" tabindex="-1">get() <a class="header-anchor" href="#get" aria-label="Permalink to &quot;get()&quot;">​</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(request: string): any</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(request: string): any</span></span></code></pre></div><p>从缓存中获取某个模块的同步值, 模块加载完毕前会获取到undefined</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#6A737D;">// undefined</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> wpmjs.</span><span style="color:#B392F0;">import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#6A737D;">// React</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">) </span><span style="color:#6A737D;">// undefined</span></span>
<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> wpmjs.</span><span style="color:#6F42C1;">import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">) </span><span style="color:#6A737D;">// React</span></span></code></pre></div><h2 id="setshared" tabindex="-1">setShared() <a class="header-anchor" href="#setshared" aria-label="Permalink to &quot;setShared()&quot;">​</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">setShared</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 模块名</span></span>
<span class="line"><span style="color:#E1E4E8;">    name: string,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 模版版本</span></span>
<span class="line"><span style="color:#E1E4E8;">    version: string,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 模块加载函数</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Promise</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#79B8FF;">any</span><span style="color:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    loaded</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> boolean </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> number;</span></span>
<span class="line"><span style="color:#E1E4E8;">    shareScope</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> string;</span></span>
<span class="line"><span style="color:#E1E4E8;">    fromType</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> string;</span></span>
<span class="line"><span style="color:#E1E4E8;">    from</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> string;</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">setShared</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 模块名</span></span>
<span class="line"><span style="color:#24292E;">    name: string,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 模版版本</span></span>
<span class="line"><span style="color:#24292E;">    version: string,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 模块加载函数</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">function</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Promise</span><span style="color:#24292E;">&lt;</span><span style="color:#005CC5;">any</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    loaded</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> boolean </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> number;</span></span>
<span class="line"><span style="color:#24292E;">    shareScope</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> string;</span></span>
<span class="line"><span style="color:#24292E;">    fromType</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> string;</span></span>
<span class="line"><span style="color:#24292E;">    from</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> string;</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre></div><p>注册一个共享模块, 共享模块支持多版本共存, <em><strong>自动在umd、system、module-federation及其shared等各种模块之间进行共享和互通</strong></em></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">setShared</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">  name: </span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  version: </span><span style="color:#9ECBFF;">&quot;18.2.0&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">async</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 可以去请求远程资源</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> System.</span><span style="color:#B392F0;">import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;https://react.js&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 也可返回本地对象</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> {test: </span><span style="color:#79B8FF;">1111</span><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">setShared</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">  name: </span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  version: </span><span style="color:#032F62;">&quot;18.2.0&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">async</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 可以去请求远程资源</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> System.</span><span style="color:#6F42C1;">import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;https://react.js&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 也可返回本地对象</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> {test: </span><span style="color:#005CC5;">1111</span><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre></div><h2 id="getshared" tabindex="-1">getShared() <a class="header-anchor" href="#getshared" aria-label="Permalink to &quot;getShared()&quot;">​</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">getShared</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">  name: string;</span></span>
<span class="line"><span style="color:#E1E4E8;">  strictVersion</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> boolean;</span></span>
<span class="line"><span style="color:#E1E4E8;">  singleton</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> boolean;</span></span>
<span class="line"><span style="color:#E1E4E8;">  shareScope</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> string;</span></span>
<span class="line"><span style="color:#E1E4E8;">  requiredVersion</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> string;</span></span>
<span class="line"><span style="color:#E1E4E8;">}): </span><span style="color:#79B8FF;">Promise</span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">any</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">getShared</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">  name: string;</span></span>
<span class="line"><span style="color:#24292E;">  strictVersion</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> boolean;</span></span>
<span class="line"><span style="color:#24292E;">  singleton</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> boolean;</span></span>
<span class="line"><span style="color:#24292E;">  shareScope</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> string;</span></span>
<span class="line"><span style="color:#24292E;">  requiredVersion</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> string;</span></span>
<span class="line"><span style="color:#24292E;">}): </span><span style="color:#005CC5;">Promise</span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">any</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><p>加载共享模块</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> wpmjs.</span><span style="color:#B392F0;">getShared</span><span style="color:#E1E4E8;">({name: </span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;">})</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> wpmjs.</span><span style="color:#B392F0;">getShared</span><span style="color:#E1E4E8;">({name: </span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;">, requiredVersion: </span><span style="color:#9ECBFF;">&quot;18.2.0&quot;</span><span style="color:#E1E4E8;">, singleton: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> wpmjs.</span><span style="color:#6F42C1;">getShared</span><span style="color:#24292E;">({name: </span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">})</span></span>
<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> wpmjs.</span><span style="color:#6F42C1;">getShared</span><span style="color:#24292E;">({name: </span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">, requiredVersion: </span><span style="color:#032F62;">&quot;18.2.0&quot;</span><span style="color:#24292E;">, singleton: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">})</span></span></code></pre></div><h2 id="sleep" tabindex="-1">sleep() <a class="header-anchor" href="#sleep" aria-label="Permalink to &quot;sleep()&quot;">​</a></h2><p>等待一段时间之后再发起加载请求</p><ol><li>动态importMap</li></ol><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(window.</span><span style="color:#B392F0;">fetch</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;https://importMap.json&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">then</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">res</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> res.</span><span style="color:#B392F0;">json</span><span style="color:#E1E4E8;">())</span></span>
<span class="line"><span style="color:#E1E4E8;">  .</span><span style="color:#B392F0;">then</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">importMap</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    wpmjs.</span><span style="color:#B392F0;">addImportMap</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">      react: {packageVersion: </span><span style="color:#9ECBFF;">&quot;17.0.2&quot;</span><span style="color:#E1E4E8;">},</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">...</span><span style="color:#E1E4E8;">importMap</span></span>
<span class="line"><span style="color:#E1E4E8;">    })</span></span>
<span class="line"><span style="color:#E1E4E8;">  })</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> wpmjs.</span><span style="color:#B392F0;">import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#6A737D;">// 17.0.2</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(window.</span><span style="color:#6F42C1;">fetch</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;https://importMap.json&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">then</span><span style="color:#24292E;">(</span><span style="color:#E36209;">res</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> res.</span><span style="color:#6F42C1;">json</span><span style="color:#24292E;">())</span></span>
<span class="line"><span style="color:#24292E;">  .</span><span style="color:#6F42C1;">then</span><span style="color:#24292E;">(</span><span style="color:#E36209;">importMap</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    wpmjs.</span><span style="color:#6F42C1;">addImportMap</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">      react: {packageVersion: </span><span style="color:#032F62;">&quot;17.0.2&quot;</span><span style="color:#24292E;">},</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">...</span><span style="color:#24292E;">importMap</span></span>
<span class="line"><span style="color:#24292E;">    })</span></span>
<span class="line"><span style="color:#24292E;">  })</span></span>
<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> wpmjs.</span><span style="color:#6F42C1;">import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">) </span><span style="color:#6A737D;">// 17.0.2</span></span></code></pre></div><h2 id="constructor" tabindex="-1">constructor() <a class="header-anchor" href="#constructor" aria-label="Permalink to &quot;constructor()&quot;">​</a></h2><p>创建新的wpmjs实例</p><ol><li>多版本共存</li></ol><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">wpmjs</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> window.wpmjs</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">wpmjs1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> wpmjs.</span><span style="color:#B392F0;">constructor</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 打印错误信息时会附带name</span></span>
<span class="line"><span style="color:#E1E4E8;">  name: </span><span style="color:#9ECBFF;">&quot;wpmjs1&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">addImportMap</span><span style="color:#E1E4E8;">({ packageName: </span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;">, packageVersion: </span><span style="color:#9ECBFF;">&quot;18.2.0&quot;</span><span style="color:#E1E4E8;">, strictVersion: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;"> })</span></span>
<span class="line"><span style="color:#E1E4E8;">wpmjs1.</span><span style="color:#B392F0;">addImportMap</span><span style="color:#E1E4E8;">({ packageName: </span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;">, packageVersion: </span><span style="color:#9ECBFF;">&quot;17.0.2&quot;</span><span style="color:#E1E4E8;">, strictVersion: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;"> })</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#6A737D;">// 18.2.0</span></span>
<span class="line"><span style="color:#E1E4E8;">wpmjs1.</span><span style="color:#B392F0;">import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;react&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#6A737D;">// 17.0.2</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">wpmjs</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> window.wpmjs</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">wpmjs1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> wpmjs.</span><span style="color:#6F42C1;">constructor</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 打印错误信息时会附带name</span></span>
<span class="line"><span style="color:#24292E;">  name: </span><span style="color:#032F62;">&quot;wpmjs1&quot;</span></span>
<span class="line"><span style="color:#24292E;">})</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">addImportMap</span><span style="color:#24292E;">({ packageName: </span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">, packageVersion: </span><span style="color:#032F62;">&quot;18.2.0&quot;</span><span style="color:#24292E;">, strictVersion: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;"> })</span></span>
<span class="line"><span style="color:#24292E;">wpmjs1.</span><span style="color:#6F42C1;">addImportMap</span><span style="color:#24292E;">({ packageName: </span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">, packageVersion: </span><span style="color:#032F62;">&quot;17.0.2&quot;</span><span style="color:#24292E;">, strictVersion: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;"> })</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">) </span><span style="color:#6A737D;">// 18.2.0</span></span>
<span class="line"><span style="color:#24292E;">wpmjs1.</span><span style="color:#6F42C1;">import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;react&quot;</span><span style="color:#24292E;">) </span><span style="color:#6A737D;">// 17.0.2</span></span></code></pre></div><h2 id="system" tabindex="-1">System <a class="header-anchor" href="#system" aria-label="Permalink to &quot;System&quot;">​</a></h2><p>使用<a href="https://npmjs.com/package/systemjs-intercept" target="_blank" rel="noreferrer">systemjs-intercept</a>拦截了加载过程的systemjs实例, 这个实例加载的模块及依赖会使用wpmjs来寻找</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.System.</span><span style="color:#B392F0;">import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;react-dom&quot;</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.System.</span><span style="color:#6F42C1;">import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;react-dom&quot;</span><span style="color:#24292E;">)</span></span></code></pre></div><h2 id="registerloader" tabindex="-1">registerLoader() <a class="header-anchor" href="#registerloader" aria-label="Permalink to &quot;registerLoader()&quot;">​</a></h2><p>注册新的模块类型与其加载器, 例:</p><ol><li>创建一个css加载器<div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">registerLoader</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">    moduleType: </span><span style="color:#9ECBFF;">&quot;css&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">resolveUrl</span><span style="color:#E1E4E8;">({</span><span style="color:#FFAB70;">name</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">version</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">query</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">entry</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">filename</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">baseUrl</span><span style="color:#E1E4E8;">}) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#9ECBFF;">/</span><span style="color:#DBEDFF;">https</span><span style="color:#F97583;">?</span><span style="color:#DBEDFF;">:</span><span style="color:#85E89D;font-weight:bold;">\\/\\/</span><span style="color:#DBEDFF;">(localhost</span><span style="color:#F97583;">|</span><span style="color:#DBEDFF;">(</span><span style="color:#79B8FF;">\\d</span><span style="color:#F97583;">+</span><span style="color:#85E89D;font-weight:bold;">\\.</span><span style="color:#DBEDFF;">)</span><span style="color:#F97583;">{2}</span><span style="color:#DBEDFF;">)</span><span style="color:#9ECBFF;">/</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">test</span><span style="color:#E1E4E8;">(baseUrl)) {</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">\`\${</span><span style="color:#E1E4E8;">baseUrl</span><span style="color:#9ECBFF;">}/\${</span><span style="color:#E1E4E8;">filename</span><span style="color:#9ECBFF;">}\`</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">        query </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> query </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;?&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> query </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        filename </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> filename </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;/&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> filename </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        version </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> version </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;@&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> version </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">\`\${</span><span style="color:#E1E4E8;">baseUrl</span><span style="color:#9ECBFF;">}/\${</span><span style="color:#E1E4E8;">name</span><span style="color:#9ECBFF;">}\${</span><span style="color:#E1E4E8;">version</span><span style="color:#9ECBFF;">}\${</span><span style="color:#E1E4E8;">filename</span><span style="color:#9ECBFF;">}\${</span><span style="color:#E1E4E8;">query</span><span style="color:#9ECBFF;">}\`</span></span>
<span class="line"><span style="color:#E1E4E8;">    },</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">resolveContainer</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">url</span><span style="color:#E1E4E8;">, {</span><span style="color:#FFAB70;">requestObj</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">pkgConfig</span><span style="color:#E1E4E8;">}) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> link </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> document.</span><span style="color:#B392F0;">createElement</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;link&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        link.href </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> url</span></span>
<span class="line"><span style="color:#E1E4E8;">        document.head.</span><span style="color:#B392F0;">appendChild</span><span style="color:#E1E4E8;">(link)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> link</span></span>
<span class="line"><span style="color:#E1E4E8;">    },</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">resolveEntry</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">container</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">entry</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">addImportMap</span><span style="color:#E1E4E8;">({ testCss: { packageName: </span><span style="color:#9ECBFF;">&quot;antd@0.0.1/dist/index.css&quot;</span><span style="color:#E1E4E8;">, moduleType: </span><span style="color:#9ECBFF;">&quot;css&quot;</span><span style="color:#E1E4E8;"> } })</span></span>
<span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">import</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;testCss&quot;</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">registerLoader</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    moduleType: </span><span style="color:#032F62;">&quot;css&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">resolveUrl</span><span style="color:#24292E;">({</span><span style="color:#E36209;">name</span><span style="color:#24292E;">, </span><span style="color:#E36209;">version</span><span style="color:#24292E;">, </span><span style="color:#E36209;">query</span><span style="color:#24292E;">, </span><span style="color:#E36209;">entry</span><span style="color:#24292E;">, </span><span style="color:#E36209;">filename</span><span style="color:#24292E;">, </span><span style="color:#E36209;">baseUrl</span><span style="color:#24292E;">}) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#032F62;">/https</span><span style="color:#D73A49;">?</span><span style="color:#032F62;">:</span><span style="color:#22863A;font-weight:bold;">\\/\\/</span><span style="color:#032F62;">(localhost</span><span style="color:#D73A49;">|</span><span style="color:#032F62;">(</span><span style="color:#005CC5;">\\d</span><span style="color:#D73A49;">+</span><span style="color:#22863A;font-weight:bold;">\\.</span><span style="color:#032F62;">)</span><span style="color:#D73A49;">{2}</span><span style="color:#032F62;">)/</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">test</span><span style="color:#24292E;">(baseUrl)) {</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#032F62;">\`\${</span><span style="color:#24292E;">baseUrl</span><span style="color:#032F62;">}/\${</span><span style="color:#24292E;">filename</span><span style="color:#032F62;">}\`</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        query </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> query </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;?&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> query </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&quot;</span></span>
<span class="line"><span style="color:#24292E;">        filename </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> filename </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;/&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> filename </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&quot;</span></span>
<span class="line"><span style="color:#24292E;">        version </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> version </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;@&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> version </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#032F62;">\`\${</span><span style="color:#24292E;">baseUrl</span><span style="color:#032F62;">}/\${</span><span style="color:#24292E;">name</span><span style="color:#032F62;">}\${</span><span style="color:#24292E;">version</span><span style="color:#032F62;">}\${</span><span style="color:#24292E;">filename</span><span style="color:#032F62;">}\${</span><span style="color:#24292E;">query</span><span style="color:#032F62;">}\`</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">resolveContainer</span><span style="color:#24292E;">(</span><span style="color:#E36209;">url</span><span style="color:#24292E;">, {</span><span style="color:#E36209;">requestObj</span><span style="color:#24292E;">, </span><span style="color:#E36209;">pkgConfig</span><span style="color:#24292E;">}) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">var</span><span style="color:#24292E;"> link </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> document.</span><span style="color:#6F42C1;">createElement</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;link&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        link.href </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> url</span></span>
<span class="line"><span style="color:#24292E;">        document.head.</span><span style="color:#6F42C1;">appendChild</span><span style="color:#24292E;">(link)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> link</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">resolveEntry</span><span style="color:#24292E;">(</span><span style="color:#E36209;">container</span><span style="color:#24292E;">, </span><span style="color:#E36209;">entry</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">addImportMap</span><span style="color:#24292E;">({ testCss: { packageName: </span><span style="color:#032F62;">&quot;antd@0.0.1/dist/index.css&quot;</span><span style="color:#24292E;">, moduleType: </span><span style="color:#032F62;">&quot;css&quot;</span><span style="color:#24292E;"> } })</span></span>
<span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">import</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;testCss&quot;</span><span style="color:#24292E;">)</span></span></code></pre></div></li><li>自定义system模块的加载行为（如url规则、执行js的方式等）<div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">registerLoader</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">resolveUrl</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> url</span></span>
<span class="line"><span style="color:#E1E4E8;">    },</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">async</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">resolveContainer</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">url</span><span style="color:#E1E4E8;">, {</span><span style="color:#FFAB70;">requestObj</span><span style="color:#E1E4E8;">}) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">eval</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">fetch</span><span style="color:#E1E4E8;">(url)).</span><span style="color:#B392F0;">text</span><span style="color:#E1E4E8;">())</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> window[requestObj.name]</span></span>
<span class="line"><span style="color:#E1E4E8;">    },</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">resolveEntry</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">container</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">entry</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> container[entry]</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">registerLoader</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">resolveUrl</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> url</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">async</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">resolveContainer</span><span style="color:#24292E;">(</span><span style="color:#E36209;">url</span><span style="color:#24292E;">, {</span><span style="color:#E36209;">requestObj</span><span style="color:#24292E;">}) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">eval</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">fetch</span><span style="color:#24292E;">(url)).</span><span style="color:#6F42C1;">text</span><span style="color:#24292E;">())</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> window[requestObj.name]</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">resolveEntry</span><span style="color:#24292E;">(</span><span style="color:#E36209;">container</span><span style="color:#24292E;">, </span><span style="color:#E36209;">entry</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> container[entry]</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre></div></li></ol><h2 id="debug" tabindex="-1">debug() <a class="header-anchor" href="#debug" aria-label="Permalink to &quot;debug()&quot;">​</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">wpmjs.</span><span style="color:#B392F0;">debug</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">    baseUrl: string; </span><span style="color:#6A737D;">// develop-panel会需要用到一些远程npm包, 此处为它设置源</span></span>
<span class="line"><span style="color:#E1E4E8;">    plugins: Array</span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">string</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// wpm-develop-panel是一个调试面板, 可以嵌入一些调试工具, 此处可以配置工具名, 会自动去加载wpm-develop-\${plugins[index]}对应的npm包</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">wpmjs.</span><span style="color:#6F42C1;">debug</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    baseUrl: string; </span><span style="color:#6A737D;">// develop-panel会需要用到一些远程npm包, 此处为它设置源</span></span>
<span class="line"><span style="color:#24292E;">    plugins: Array</span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">string</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// wpm-develop-panel是一个调试面板, 可以嵌入一些调试工具, 此处可以配置工具名, 会自动去加载wpm-develop-\${plugins[index]}对应的npm包</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre></div><p>打开调试面板, 可以使用系统插件和自定义插件</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">window.wpmjsDebug.</span><span style="color:#B392F0;">debug</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">    baseUrl: </span><span style="color:#9ECBFF;">&quot;https://cdn.jsdelivr.net/npm&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    plugins: [</span><span style="color:#9ECBFF;">&quot;connect&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;alias&quot;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">window.wpmjsDebug.</span><span style="color:#6F42C1;">debug</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    baseUrl: </span><span style="color:#032F62;">&quot;https://cdn.jsdelivr.net/npm&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    plugins: [</span><span style="color:#032F62;">&quot;connect&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;alias&quot;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre></div>`,62),t=[e];function c(r,E,y,i,u,d){return a(),n("div",null,t)}const g=s(o,[["render",c]]);export{m as __pageData,g as default};
